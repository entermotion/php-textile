hasRawText() tag case insensitivity and closure:
  note: Although xhtml calls for lower-case tag names with all tags closed (even on void elements), Textile doesn't care if xhtml in its input is well formed, it just has to output it verbatim. Therefore we use the more relaxed HTML5 rules (allowing for mixed case element names) for detecting 'raw' input text. In addition, xhtml allows void tags to be closed like normal tags (so <hr></hr> is valid in xhtml) and Textile should let these through untouched too.
  input: |
    <hr>

    <hr/>

    <hr >

    <hr />

    <hr  >

    <hr  />

    <hr></hr>

    <hr class="whatnot"></hr >

    <hr  ></hr  >

    <HR>

    <HR/>

    <HR >

    <HR />

    <HR  >

    <HR  />

    <img src="blahblah.jpg" />

    <p>Hello World!</p>

    <P>Hello World!</P>

    <P>Hello World!</p>

    <p>Hello World!</P>

  expect: |
    <hr>

    <hr/>

    <hr >

    <hr />

    <hr  >

    <hr  />

    <hr></hr>

    <hr class="whatnot"></hr >

    <hr  ></hr  >

    <HR>

    <HR/>

    <HR >

    <HR />

    <HR  >

    <HR  />

    <img src="blahblah.jpg" />

    <p>Hello World!</p>

    <P>Hello World!</P>

    <P>Hello World!</p>

    <p>Hello World!</P>

Case insensitive p breaks:
  input: |
    I spoke.
    And none replied.

    I spoke.<br>
    And none replied.

    I spoke.<br/>
    And none replied.

    I spoke.<br />
    And none replied.

    I spoke.<BR>
    And none replied.

    I spoke.<BR/>
    And none replied.

    I spoke.<BR />
    And none replied.
  expect: |
    <p>I spoke.<br />
    And none replied.</p>

    <p>I spoke.<br />
    And none replied.</p>

    <p>I spoke.<br />
    And none replied.</p>

    <p>I spoke.<br />
    And none replied.</p>

    <p>I spoke.<br />
    And none replied.</p>

    <p>I spoke.<br />
    And none replied.</p>

    <p>I spoke.<br />
    And none replied.</p>

Mixed HTML and Textile:
  input: |
    <p>*foo*</p>

    <p>*foo*[^2^]</p>

  expect: |
    <p><strong>foo</strong></p>

    <p><strong>foo</strong><sup>2</sup></p>

Styled numbers:
  input: |
    _(class1 class2#id1)1_ *[en]2* **(#id)3** ??4?? __5__ %6% +7+ -(foobarbaz#boom bang)8- ~9~ ^10^

    1[^st^], 2[^nd^], 3[^rd^]
  expect: |
    <p><em class="class1 class2" id="id1">1</em> <strong lang="en">2</strong> <b id="id">3</b> <cite>4</cite> <i>5</i> <span>6</span> <ins>7</ins> <del class="foobarbaz">8</del> <sub>9</sub> <sup>10</sup></p>

    <p>1<sup>st</sup>, 2<sup>nd</sup>, 3<sup>rd</sup></p>

Percentages:
  input: |
    0 %1% _2_ 45% 6.7% %89.0
  expect: |
    <p>0 <span>1</span> <em>2</em> 45% 6.7% %89.0</p>

Some redding:
  input: |
    h2{color:red}. Some redding
  expect: |
    <h2 style="color:red;">Some redding</h2>

Basic glyphs:
  input: |
    "Textile(c)" is a registered(r) 'trademark' of Textpattern(tm) -- or TXP(That's textpattern!) -- at least it was - back in '88 when 2x4 was (+/-)5(o)C ... QED!

    p{font-size: 200%;}. 2(1/4) 3(1/2) 4(3/4)

    "." ".." "..." '.' '..' '...' Allow quoted periods.
  expect: |
    <p>&#8220;Textile&#169;&#8221; is a registered&#174; &#8216;trademark&#8217; of Textpattern&#8482; &#8212; or <acronym title="That&#8217;s textpattern!"><span class="caps">TXP</span></acronym> &#8212; at least it was &#8211; back in &#8217;88 when 2&#215;4 was &#177;5&#176;C &#8230; <span class="caps">QED</span>!</p>

    <p style="font-size: 200%;">2&#188; 3&#189; 4&#190;</p>

    <p>&#8220;.&#8221; &#8220;..&#8221; &#8220;&#8230;&#8221; &#8216;.&#8217; &#8216;..&#8217; &#8216;&#8230;&#8217; Allow quoted periods.</p>

Classes and IDs:
  input: |
    p(c). Valid class

    p(#id). Valid ID

    p(c#id). Valid class and ID

    p(c9). Valid class

    p(c4.2). Valid class

    p(c1 c.2 c-3). Valid class
  expect: |
    <p class="c">Valid class</p>

    <p id="id">Valid ID</p>

    <p class="c" id="id">Valid class and ID</p>

    <p class="c9">Valid class</p>

    <p class="c4.2">Valid class</p>

    <p class="c1 c.2 c-3">Valid class</p>

Dimensions:
  input: |
    [1/2] x [1/4] and (1/2)" x [1/4]" and (1/2)' x (1/4)'

    (2 x 10) X (3 / 4) x (200 + 64)

    1 x 1 = 1

    1 x1 = 1

    1x 1 = 1

    1x1 = 1

    1 X 1 = 1

    1 X1 = 1

    1X 1 = 1

    1X1 = 1

    What is 1 x 1?

    What is 1x1?

    What is 1 X 1?

    What is 1X1?

    1 x 2 x 3 = 6

    1x2x3=6

    1x2 x 1x3 = 6

    2' x 2' = 4 sqft.

    2'x 2' = 4 sqft.

    2' x2' = 4 sqft.

    2'x2' = 4 sqft.

    2' X 2' = 4 sqft.

    2'X 2' = 4 sqft.

    2' X2' = 4 sqft.

    2'X2' = 4 sqft.

    2" x 2" = 4 sqin.

    2"x 2" = 4 sqin.

    2" x2" = 4 sqin.

    2"x2" = 4 sqin.

    2" X 2" = 4 sqin.

    2"X 2" = 4 sqin.

    2" X2" = 4 sqin.

    2"X2" = 4in[^2^].

    What is 1.2 x 3.5?

    What is .2 x .5?

    What is 1.2x3.5?

    What is .2x.5?

    What is 1.2' x3.5'?

    What is .2"x .5"?

    1 x $10.00 x -£ 1.23 x ¥20,000 x -¤120.00 x ฿1,000,000 x -€110,00
  expect: |
    <p>&#189; &#215; &#188; and &#189;&#8221; &#215; &#188;&#8221; and &#189;&#8217; &#215; &#188;&#8217;</p>

    <p>(2 &#215; 10) &#215; (3 / 4) &#215; (200 + 64)</p>

    <p>1 &#215; 1 = 1</p>

    <p>1 &#215;1 = 1</p>

    <p>1&#215; 1 = 1</p>

    <p>1&#215;1 = 1</p>

    <p>1 &#215; 1 = 1</p>

    <p>1 &#215;1 = 1</p>

    <p>1&#215; 1 = 1</p>

    <p>1&#215;1 = 1</p>

    <p>What is 1 &#215; 1?</p>

    <p>What is 1&#215;1?</p>

    <p>What is 1 &#215; 1?</p>

    <p>What is 1&#215;1?</p>

    <p>1 &#215; 2 &#215; 3 = 6</p>

    <p>1&#215;2&#215;3=6</p>

    <p>1&#215;2 &#215; 1&#215;3 = 6</p>

    <p>2&#8217; &#215; 2&#8217; = 4 sqft.</p>

    <p>2&#8217;&#215; 2&#8217; = 4 sqft.</p>

    <p>2&#8217; &#215;2&#8217; = 4 sqft.</p>

    <p>2&#8217;&#215;2&#8217; = 4 sqft.</p>

    <p>2&#8217; &#215; 2&#8217; = 4 sqft.</p>

    <p>2&#8217;&#215; 2&#8217; = 4 sqft.</p>

    <p>2&#8217; &#215;2&#8217; = 4 sqft.</p>

    <p>2&#8217;&#215;2&#8217; = 4 sqft.</p>

    <p>2&#8221; &#215; 2&#8221; = 4 sqin.</p>

    <p>2&#8221;&#215; 2&#8221; = 4 sqin.</p>

    <p>2&#8221; &#215;2&#8221; = 4 sqin.</p>

    <p>2&#8221;&#215;2&#8221; = 4 sqin.</p>

    <p>2&#8221; &#215; 2&#8221; = 4 sqin.</p>

    <p>2&#8221;&#215; 2&#8221; = 4 sqin.</p>

    <p>2&#8221; &#215;2&#8221; = 4 sqin.</p>

    <p>2&#8221;&#215;2&#8221; = 4in<sup>2</sup>.</p>

    <p>What is 1.2 &#215; 3.5?</p>

    <p>What is .2 &#215; .5?</p>

    <p>What is 1.2&#215;3.5?</p>

    <p>What is .2&#215;.5?</p>

    <p>What is 1.2&#8217; &#215;3.5&#8217;?</p>

    <p>What is .2&#8221;&#215; .5&#8221;?</p>

    <p>1 &#215; $10.00 &#215; -£ 1.23 &#215; ¥20,000 &#215; -¤120.00 &#215; ฿1,000,000 &#215; -€110,00</p>

Ruud's Improvements:
  input: |
    ??*text*??

    _person_'s

    *person*'s

    "text":http://url/"

    "text":http://url...

    *CAPS "text":http://url*

    "_text_"

    *- text -*

    <text *text*
  expect: |
    <p><cite><strong>text</strong></cite></p>

    <p><em>person</em>&#8217;s</p>

    <p><strong>person</strong>&#8217;s</p>

    <p><a href="http://url/">text</a>&#8221;</p>

    <p><a href="http://url">text</a>&#8230;</p>

    <p><strong><span class="caps">CAPS</span> <a href="http://url">text</a></strong></p>

    <p>&#8220;<em>text</em>&#8221;</p>

    <p><strong>&#8211; text &#8211;</strong></p>

    <p>&lt;text <strong>text</strong></p>

Other Ruud stuff:
  input: |
    *

    **

    * item1
  expect: |
    <p>*</p>

    <p>**</p>

    <ul>
    	<li>item1</li>
    </ul>

Punctuation:
  input: |
    Greengrocers' apostrophe's.

    '"I swear it was in '62, captain," replied I.'

    Dad said; "Mum said: 'It's a beautiful day viz-a-viz a picnic, isn't it?' -- _I think_."

    "'I swear it's true, captain,' replied I, 'Here's your list: 2 apples, a banana & a papaya.'"

    in '88. blah. In the '90s blah. He's in his '90s' now.

    Happened in '89.

    in '89

    in '89\x20

    Happened in '89. it did.

    File '1.png'. '1.' '1' '10m' '1.txt'

    NATO(North Atlantic Treaty Organisation)'s pretty big.

    ABC()'s poor knees.

    ABC('s poor knees.

    ABC)'s poor knees.

    Here is a %(example)'spanned'% word.

    The NHS(National Health Service)' charter states...
  expect: |
    <p>Greengrocers&#8217; apostrophe&#8217;s.</p>

    <p>&#8216;&#8220;I swear it was in &#8217;62, captain,&#8221; replied I.&#8217;</p>

    <p>Dad said; &#8220;Mum said: &#8216;It&#8217;s a beautiful day viz-a-viz a picnic, isn&#8217;t it?&#8217; &#8212; <em>I think</em>.&#8221;</p>

    <p>&#8220;&#8216;I swear it&#8217;s true, captain,&#8217; replied I, &#8216;Here&#8217;s your list: 2 apples, a banana &amp; a papaya.&#8217;&#8221;</p>

    <p>in &#8217;88. blah. In the &#8217;90s blah. He&#8217;s in his &#8216;90s&#8217; now.</p>

    <p>Happened in &#8217;89.</p>

    <p>in &#8217;89</p>

    <p>in &#8217;89 </p>

    <p>Happened in &#8217;89. it did.</p>

    <p>File &#8216;1.png&#8217;. &#8216;1.&#8217; &#8216;1&#8217; &#8216;10m&#8217; &#8216;1.txt&#8217;</p>

    <p><acronym title="North Atlantic Treaty Organisation"><span class="caps">NATO</span></acronym>&#8217;s pretty big.</p>

    <p><acronym title=""><span class="caps">ABC</span></acronym>&#8217;s poor knees.</p>

    <p><span class="caps">ABC</span>(&#8216;s poor knees.</p>

    <p><span class="caps">ABC</span>)&#8217;s poor knees.</p>

    <p>Here is a <span class="example">&#8216;spanned&#8217;</span> word.</p>

    <p>The <acronym title="National Health Service"><span class="caps">NHS</span></acronym>&#8217; charter states&#8230;</p>

Dashes and ellipsis:
  notes: |
      '--' should be replaced with em-dash, ' - ' with en-dash (but not inside another sequence of characters) and '...' with elipsis.
  input: |
    You know the Italian proverb -- Chi ha compagno ha padrone.

    You know the Italian proverb--Chi ha compagno ha padrone.

    You know the Italian proverb - Chi ha compagno ha padrone.

    You know the Italian proverb-Chi ha compagno ha padrone.

    You know the Italian proverb... Chi ha compagno ha padrone.

    You know the Italian proverb...Chi ha compagno ha padrone.
  expect: |
    <p>You know the Italian proverb &#8212; Chi ha compagno ha padrone.</p>

    <p>You know the Italian proverb&#8212;Chi ha compagno ha padrone.</p>

    <p>You know the Italian proverb &#8211; Chi ha compagno ha padrone.</p>

    <p>You know the Italian proverb-Chi ha compagno ha padrone.</p>

    <p>You know the Italian proverb&#8230; Chi ha compagno ha padrone.</p>

    <p>You know the Italian proverb&#8230;Chi ha compagno ha padrone.</p>

Tricky Open Quotes:
  input: |
    citation ["(Berk.) Hilton"], see
    [Papers "blah blah."]

    Hello ("Mum")...

    Hello ["(mum) & dad"], see...

    Hello ("[mum] & dad"), see...

    Hello {"(mum) & dad"}, see...

    ["Well, well (well)"] ...

    citation ['(Berk.) Hilton'], see
    [Papers "blah blah."]

    Hello ('Mum')...

    Hello ['(mum) & dad'], see...

    Hello ('[mum] & dad'), see...

    Hello {'(mum) & dad'}, see...

    ['Well, well (well)'] ...
  expect: |
    <p>citation [&#8220;(Berk.) Hilton&#8221;], see<br />
    [Papers &#8220;blah blah.&#8221;]</p>

    <p>Hello (&#8220;Mum&#8221;)&#8230;</p>

    <p>Hello [&#8220;(mum) &amp; dad&#8221;], see&#8230;</p>

    <p>Hello (&#8220;[mum] &amp; dad&#8221;), see&#8230;</p>

    <p>Hello {&#8220;(mum) &amp; dad&#8221;}, see&#8230;</p>

    <p>[&#8220;Well, well (well)&#8221;] &#8230;</p>

    <p>citation [&#8216;(Berk.) Hilton&#8217;], see<br />
    [Papers &#8220;blah blah.&#8221;]</p>

    <p>Hello (&#8216;Mum&#8217;)&#8230;</p>

    <p>Hello [&#8216;(mum) &amp; dad&#8217;], see&#8230;</p>

    <p>Hello (&#8216;[mum] &amp; dad&#8217;), see&#8230;</p>

    <p>Hello {&#8216;(mum) &amp; dad&#8217;}, see&#8230;</p>

    <p>[&#8216;Well, well (well)&#8217;] &#8230;</p>

Notextile:
  input: |
    ==*no* <b>textile</b>==

    ==
    This text should never,
    ever, ever, ever, ever
    be "textiled(tm)"!
    ==

    But "this(tm)" should be whilst, yet again, >==this(tm)==< should _not_!

    notextile. * item 1
    * item 2

    notextile.. *long*

    *block*
  expect: |
    <p>*no* <b>textile</b></p>

    <p>
    This text should never,
    ever, ever, ever, ever
    be "textiled(tm)"!
    </p>

    <p>But &#8220;this&#8482;&#8221; should be whilst, yet again, &gt;this(tm)&lt; should <em>not</em>!</p>

    * item 1
    * item 2

    *long*

    *block*

Pre-formatted content:
  input: |
    pre. *This* _should_ not be parsed.

    pre.. * item 1
    * item 2

    * item 3

    p. Paragraph.

    <pre>sdada <a href="link">Link</a> @code@ dadsada</pre>
  expect: |
    <pre>*This* _should_ not be parsed.</pre>

    <pre>* item 1
    * item 2

    * item 3</pre>

    <p>Paragraph.</p>

    <pre>sdada &lt;a href=&quot;link&quot;&gt;Link&lt;/a&gt; <code>code</code> dadsada</pre>

Headers 1-6:
  input: |
    h1. Heading 1

    h2. Heading 2.

    h3. Heading 3..

    h4. Heading 4...

    h5. Heading 5....

    h6. Heading 6.....

    h1. Two line with *strong*
    heading

    h1=. Centered headline
  expect: |
    <h1>Heading 1</h1>

    <h2>Heading 2.</h2>

    <h3>Heading 3..</h3>

    <h4>Heading 4&#8230;</h4>

    <h5>Heading 5&#8230;.</h5>

    <h6>Heading 6&#8230;..</h6>

    <h1>Two line with <strong>strong</strong><br />
    heading</h1>

    <h1 style="text-align:center;">Centered headline</h1>

Paragraph text:
  notes: Paragraphs should be properly wrapped in <p>...</p> tags and newlines replaced with <br /> tags.
  input: |
    A paragraph.

    Another paragraph.

    A paragraph with
    a line break.

    Here's some <b>bold</b> text.
  expect: |
    <p>A paragraph.</p>

    <p>Another paragraph.</p>

    <p>A paragraph with<br />
    a line break.</p>

    <p>Here&#8217;s some <b>bold</b> text.</p>

Paragraph with attributes:
  input: |
    p(class#id)[en-us]{color: blue;}. (also applied by default)
  expect: |
    <p class="class" id="id" lang="en-us" style="color: blue;">(also applied by default)</p>

Paragraphs with alignment:
  input: |
    p<. Left-aligned paragraph.

    p>. Right-aligned paragraph.

    p<>. Forasmuch as many have taken in hand to set forth in order a declaration of those things which are most surely believed among us, even as they delivered them unto us, which from the beginning were eyewitnesses, and ministers of the word; it seemed good to me also, having had perfect understanding of all things from the very first, to write unto thee in order, most excellent Theophilus, that thou mightest know the certainty of those things, wherein thou hast been instructed.

    p=. Centered paragraph.

    p&lt;. Left-aligned too.

    p&gt;. Right-aligned too.

    p&lt;&gt;. Justified too.
  expect: |
    <p style="text-align:left;">Left-aligned paragraph.</p>

    <p style="text-align:right;">Right-aligned paragraph.</p>

    <p style="text-align:justify;">Forasmuch as many have taken in hand to set forth in order a declaration of those things which are most surely believed among us, even as they delivered them unto us, which from the beginning were eyewitnesses, and ministers of the word; it seemed good to me also, having had perfect understanding of all things from the very first, to write unto thee in order, most excellent Theophilus, that thou mightest know the certainty of those things, wherein thou hast been instructed.</p>

    <p style="text-align:center;">Centered paragraph.</p>

    <p style="text-align:left;">Left-aligned too.</p>

    <p style="text-align:right;">Right-aligned too.</p>

    <p style="text-align:justify;">Justified too.</p>

Paragraphs with padding:
  input: |
    p((((((((((. Left pad 10em.

    p)). Right pad 2em.

    p((())). Left and right pad 3em.
  expect: |
    <p style="padding-left:10em;">Left pad 10em.</p>

    <p style="padding-right:2em;">Right pad 2em.</p>

    <p style="padding-left:3em;padding-right:3em;">Left and right pad 3em.</p>

Nested block modifiers:
  input: |
    _*^Here^ -is a- +are two+ things.*_

    A[*bold*]word. End-of-line __italic__.

    *_^Here^ -is a- +are two+ things._*

    _*em ^strong^*_ __**??&??**__ *_strong ~em~_*
  expect: |
    <p><em><strong><sup>Here</sup> <del>is a</del> <ins>are two</ins> things.</strong></em></p>

    <p>A<strong>bold</strong>word. End-of-line <i>italic</i>.</p>

    <p><strong><em><sup>Here</sup> <del>is a</del> <ins>are two</ins> things.</em></strong></p>

    <p><em><strong>em <sup>strong</sup></strong></em> <i><b><cite>&amp;</cite></b></i> <strong><em>strong <sub>em</sub></em></strong></p>

Parenthesised block modifiers:
  input: |
    Simple solutions (_*are* the_ best) [for _Komplex(tm)_ people].

    Both (*strong*), and (_emphasis_) will be rendered with formatting.

    Both [[*strong*]], and [[_emphasis_]] will be rendered with formatting.
  expect: |
    <p>Simple solutions (<em><strong>are</strong> the</em> best) [for <em>Komplex&#8482;</em> people].</p>

    <p>Both (<strong>strong</strong>), and (<em>emphasis</em>) will be rendered with formatting.</p>

    <p>Both [<strong>strong</strong>], and [<em>emphasis</em>] will be rendered with formatting.</p>

Well formed HTML:
  notes: Paragraphs that consist entirely of raw XHTML block tags will not be enclosed in <p>...</p> tags.
  input: |
    <div class="foo">
    <span>blah</span>
    </div>
  expect: |
    <div class="foo">
    <span>blah</span>
    </div>

Partial HTML spans:
  notes: HTML tags that enclose only part of a block of text will be left intact, BUT the whole block itself will be treated normally.
  input: |
    <b>bold</b> and <i>italic</i>, the hard way.
  expect: |
    <p><b>bold</b> and <i>italic</i>, the hard way.</p>

Mixed HTML and Textile Links:
  skip: true
  notes: |
    Reported here: http://forum.textpattern.com/viewtopic.php?pid=157506#p157506
  input: |
    <a href="http://example.org" title="_dummy">example.org</a> _word_ abc
  expect: |
    <p><a href="http://example.org" title="_dummy">example.org</a> <em>word</em> abc</p>

Links with quoted text:
  notes: Single quotes link text are fine, but double quotes break the link. Use &quot; in this case.
  input: |
    "How free markets 'address' health care(title)":http://krugman.blogs.nytimes.com/2009/07/25/why-markets-cant-cure-healthcare/

    "How free markets &quot;address&quot; health care(title)":http://krugman.blogs.nytimes.com/2009/07/25/why-markets-cant-cure-healthcare/
  expect: |
    <p><a href="http://krugman.blogs.nytimes.com/2009/07/25/why-markets-cant-cure-healthcare/" title="title">How free markets &#8216;address&#8217; health care</a></p>

    <p><a href="http://krugman.blogs.nytimes.com/2009/07/25/why-markets-cant-cure-healthcare/" title="title">How free markets &quot;address&quot; health care</a></p>

Image:
  input: |
    !http://textpattern.com/favicon.ico!

    !<http://textpattern.com/favicon.ico!

    !>http://textpattern.com/favicon.ico!
  expect: |
    <p><img alt="" src="http://textpattern.com/favicon.ico" /></p>

    <p><img align="left" alt="" src="http://textpattern.com/favicon.ico" /></p>

    <p><img align="right" alt="" src="http://textpattern.com/favicon.ico" /></p>

Relative images:
  input: |
    !10x10.gif!
  expect: |
    <p><img alt="" height="10" src="10x10.gif" width="10" /></p>

Relative images (responsive):
  setup:
    - setDimensionlessImages: true
  input  : |
    !10x10.gif!
  expect : |
    <p><img alt="" src="10x10.gif" /></p>

Unicode image src, alt and title:
  input: |
    !大阪府.png(大阪府)!
  expect: |
    <p><img alt="大阪府" src="大阪府.png" title="大阪府" /></p>

Images with links:
  input: |
    Here's the favicon from the TXP(Textpattern) website... !http://textpattern.com/favicon.ico(title text)!:http://textpattern.com

    Again, this time left aligned. !<(class#id1)http://textpattern.com/favicon.ico(title text)!:http://textpattern.com

    And again, to the right! !>(class#id2)http://textpattern.com/favicon.ico(title text)!:http://textpattern.com
  expect : |
    <p>Here&#8217;s the favicon from the <acronym title="Textpattern"><span class="caps">TXP</span></acronym> website&#8230; <a href="http://textpattern.com"><img alt="title text" src="http://textpattern.com/favicon.ico" title="title text" /></a></p>

    <p>Again, this time left aligned. <a href="http://textpattern.com"><img align="left" alt="title text" class="class" id="id1" src="http://textpattern.com/favicon.ico" title="title text" /></a></p>

    <p>And again, to the right! <a href="http://textpattern.com"><img align="right" alt="title text" class="class" id="id2" src="http://textpattern.com/favicon.ico" title="title text" /></a></p>

Embedded acronym inside acronym:
  input: |
    Tell me, what is AJAX(Asynchronous Javascript and XML), please?
  expect: |
    <p>Tell me, what is <acronym title="Asynchronous Javascript and XML"><span class="caps">AJAX</span></acronym>, please?</p>

Issue 71 - Emphasis:
  notes: |
    Tests conversion to apostrophe-s at the end of block modifiers. http://code.google.com/p/textpattern/issues/detail?id=71
  input: |
    _Newsweek_'s a problem.

    "_Newsweek_'s a problem."

    "_Newsweek_'s a problem."

    "_Newsweek_'s" a problem.

    *Newsweek*'s a problem.

    "*Newsweek*'s a problem."

    "*Newsweek*'s a problem."

    "*Newsweek*'s" a problem.

    "*Newsweek*'s"
    a problem.

    -Newsweek-'s a problem.
  expect: |
    <p><em>Newsweek</em>&#8217;s a problem.</p>

    <p>&#8220;<em>Newsweek</em>&#8217;s a problem.&#8221;</p>

    <p>&#8220;<em>Newsweek</em>&#8217;s a problem.&#8221;</p>

    <p>&#8220;<em>Newsweek</em>&#8217;s&#8221; a problem.</p>

    <p><strong>Newsweek</strong>&#8217;s a problem.</p>

    <p>&#8220;<strong>Newsweek</strong>&#8217;s a problem.&#8221;</p>

    <p>&#8220;<strong>Newsweek</strong>&#8217;s a problem.&#8221;</p>

    <p>&#8220;<strong>Newsweek</strong>&#8217;s&#8221; a problem.</p>

    <p>&#8220;<strong>Newsweek</strong>&#8217;s&#8221;<br />
    a problem.</p>

    <p><del>Newsweek</del>&#8217;s a problem.</p>

Single quotes 1:
  input: |
    'Here is a quote!'

    'Here is another
    quote!'
  expect: |
    <p>&#8216;Here is a quote!&#8217;</p>

    <p>&#8216;Here is another<br />
    quote!&#8217;</p>

Single quotes enclosing normal apostrophes 1:
  input: |
    'Here's a quote!'

    'Here's another
    quote!'
  expect: |
    <p>&#8216;Here&#8217;s a quote!&#8217;</p>

    <p>&#8216;Here&#8217;s another<br />
    quote!&#8217;</p>

Single quotes enclosing normal apostrophes + emphasis:
  input: |
    'Here's a _quote_!'

    'Here's a
    _quote_!'
  expect: |
    <p>&#8216;Here&#8217;s a <em>quote</em>!&#8217;</p>

    <p>&#8216;Here&#8217;s a<br />
    <em>quote</em>!&#8217;</p>

Single quotes enclosing italic apostrophes:
  input: |
    '__Here__'s a quote!'

    '__Here__'s
    a quote!'
  expect: |
    <p>&#8216;<i>Here</i>&#8217;s a quote!&#8217;</p>

    <p>&#8216;<i>Here</i>&#8217;s<br />
    a quote!&#8217;</p>

Link in quotes:
  input: |
    "Here's a "(class#id)link(with a title)":http://cnn.com?a=b&c=d#end_of_page."
  expect: |
    <p>&#8220;Here&#8217;s a <a class="class" href="http://cnn.com?a=b&amp;c=d#end_of_page" id="id" title="with a title">link</a>.&#8221;</p>

Double quotes enclosing spans:
  input: |
    "Here's another one"

    Well "%here's another one%"

    Well "%+here+'s another one%"

    Well "%*here*'s another one%"

    Well "%_here_'s another one%"

    Well "%(class#id)_here_'s another one%"

    Well "%(class#id)_here_'s -yet _**another**_ ^example^ ~of~- *one*'s% "results":http://cnn.com. Howzat!" With "some *^more^* results":http://cnn.com

    "Should _Newsweek_'s editor be spared?"
  expect: |
    <p>&#8220;Here&#8217;s another one&#8221;</p>

    <p>Well &#8220;<span>here&#8217;s another one</span>&#8221;</p>

    <p>Well &#8220;<span><ins>here</ins>&#8217;s another one</span>&#8221;</p>

    <p>Well &#8220;<span><strong>here</strong>&#8217;s another one</span>&#8221;</p>

    <p>Well &#8220;<span><em>here</em>&#8217;s another one</span>&#8221;</p>

    <p>Well &#8220;<span class="class" id="id"><em>here</em>&#8217;s another one</span>&#8221;</p>

    <p>Well &#8220;<span class="class" id="id"><em>here</em>&#8217;s <del>yet <em><b>another</b></em> <sup>example</sup> <sub>of</sub></del> <strong>one</strong>&#8217;s</span> <a href="http://cnn.com">results</a>. Howzat!&#8221; With <a href="http://cnn.com">some <strong><sup>more</sup></strong> results</a></p>

    <p>&#8220;Should <em>Newsweek</em>&#8217;s editor be spared?&#8221;</p>

Single quotes or apostrophe?:
  input: |
    'should this quote start with an apostrophe?'

    '"s" is my favourite letter!'
  expect: |
    <p>&#8216;should this quote start with an apostrophe?&#8217;</p>

    <p>&#8216;&#8220;s&#8221; is my favourite letter!&#8217;</p>

Foreign character and quote support:
  input: |
    Ou est l'école, l'église s'il vous plâit?

    I like l'entrées. Do you?

    «Bonjour!» ecris Christophe. «Est-ce-que tu un petit café», he asked somewhat confusingly.

    SÆLGES d'être
  expect: |
    <p>Ou est l&#8217;école, l&#8217;église s&#8217;il vous plâit?</p>

    <p>I like l&#8217;entrées. Do you?</p>

    <p>«Bonjour!» ecris Christophe. «Est-ce-que tu un petit café», he asked somewhat confusingly.</p>

    <p><span class="caps">SÆLGES</span> d&#8217;être</p>

Basic span modifiers and glyphs:
  input: |
    This is the "start" and 'end'; and I'm stuck in '88!: With smd_g4llery's attributes where hÃ«ll_won't__fr33ze_over if I use apostrophes inside odd words and_underscores (Pah).
  expect: |
    <p>This is the &#8220;start&#8221; and &#8216;end&#8217;; and I&#8217;m stuck in &#8217;88!: With smd_g4llery&#8217;s attributes where hÃ«ll_won&#8217;t__fr33ze_over if I use apostrophes inside odd words and_underscores (Pah).</p>

In-line citations:
  input: |
    A ??(myclass#myid4){color:green}[de-de]complex?? phrase.
  expect: |
    <p>A <cite class="myclass" id="myid4" lang="de-de" style="color:green;">complex</cite> phrase.</p>

Square-brackets:
  input: |
    1[^st^], 2[^nd^], 3[^rd^]. 2 log[~n~]

    A close[!http://textpattern.com/favicon.ico!]image.
    A tight["text":http://textpattern.com/]link.
    A ["footnoted link":http://textpattern.com/][182].
  expect: |
    <p>1<sup>st</sup>, 2<sup>nd</sup>, 3<sup>rd</sup>. 2 log<sub>n</sub></p>

    <p>A close<img alt="" src="http://textpattern.com/favicon.ico" />image.<br />
    A tight<a href="http://textpattern.com/">text</a>link.<br />
    A <a href="http://textpattern.com/">footnoted link</a><sup class="footnote" id="fnrev"><a href="#fn">182</a></sup>.</p>

Issue 50 Bust-a-quotes:
  skip: true
  notes: >
    This is issue 50 in the code tracker.
    However, I don't think this is valid textile as it's a mix of XHTML and textile smartquotes.
    If this is fully XHMTL, character entities should be used at the start and end of the string.
    If it's textile, then it should be "%[en]test%" or %[en]"test"%.
  input: |
    "<span lang="en">test</span>"
  expect: |
    <p>&#8220;<span lang="en">test</span>&#8221;</p>

Issue 50 Fixes:
  notes: >
    Here are the possible rewrites for issue 50 that give the results the issue author was expecting.
  input: |
    &#8220;<span lang="en">test</span>&#8221;

    "%[en]test%"
  expect: |
    <p>&#8220;<span lang="en">test</span>&#8221;</p>

    <p>&#8220;<span lang="en">test</span>&#8221;</p>

Issue 1 ... Bold it - it bold :
  input: |
    Some italic bold _*aaaa*_ text? Some bold italic *_bbbb_* text?
  expect: |
    <p>Some italic bold <em><strong>aaaa</strong></em> text? Some bold italic <strong><em>bbbb</em></strong> text?</p>

1-line blockquote:
  input: |
    bq. Don't suck the brown stuff off of 2 pence coins; it ain't chocolate.
  expect: |
    <blockquote>
    	<p>Don&#8217;t suck the brown stuff off of 2 pence coins; it ain&#8217;t chocolate.</p>
    </blockquote>
1-line blockquote 2:
  input: |
    bq. Don't suck the **brown stuff(tm)** off of "2 pence":http://royalmint.gov.uk coins; it ain't chocolate.
  expect: |
    <blockquote>
    	<p>Don&#8217;t suck the <b>brown stuff&#8482;</b> off of <a href="http://royalmint.gov.uk">2 pence</a> coins; it ain&#8217;t chocolate.</p>
    </blockquote>
n-line blockquote:
  input: |
    bq.. Don't suck the **brown stuff(tm)** off of "2 pence":http://royalmint.gov.uk coins; it ain't chocolate.

    p. That's all.
  expect: |
    <blockquote>
    	<p>Don&#8217;t suck the <b>brown stuff&#8482;</b> off of <a href="http://royalmint.gov.uk">2 pence</a> coins; it ain&#8217;t chocolate.</p>
    </blockquote>

    <p>That&#8217;s all.</p>

Blockquote with citation source:
  input: |
    bq.:http://textism.com/ Text...
  expect: |
    <blockquote cite="http://textism.com/">
    	<p>Text&#8230;</p>
    </blockquote>

All capitals comment post:
  input: |
    HELLO, I SEE YOU DON'T LIKE PEOPLE TO SHOUT. WHY?
  expect: |
    <p><span class="caps">HELLO</span>, I <span class="caps">SEE</span> <span class="caps">YOU</span> <span class="caps">DON</span>&#8217;T <span class="caps">LIKE</span> <span class="caps">PEOPLE</span> TO <span class="caps">SHOUT</span>. <span class="caps">WHY</span>?</p>

Basic footnote reference and footnote:
  notes: |
    Standard footrefs and footnotes from textile 2.0.
    The textile tester removes the random ID from the text returned by textile in this test. This allows the rest of the output to be tested.
  input: |
    See[1] for details -- or perhaps[100] at a push.

    fn1. Here are the details.

    fn100(footy#otherid). A totally unrelated footnote.
  expect: |
    <p>See<sup class="footnote" id="fnrev"><a href="#fn">1</a></sup> for details &#8212; or perhaps<sup class="footnote" id="fnrev"><a href="#fn">100</a></sup> at a push.</p>

    <p class="footnote" id="fn"><sup>1</sup> Here are the details.</p>

    <p class="footy" id="otherid"><sup id="fn">100</sup> A totally unrelated footnote.</p>

Cross linked footref and footnote:
  notes: |
    Uses the '^' modifier on the footnote to turn on reverse linking to the *first* use of the corresponding reference
    The textile tester removes the random ID from the text returned by textile in this test. This allows the rest of the output to be tested.
  input: |
    See[2] for details, and later, reference it again[2].

    fn2^(footy#otherid)[en]. Here are the details.
  expect: |
    <p>See<sup class="footnote" id="fnrev"><a href="#fn">2</a></sup> for details, and later, reference it again<sup class="footnote"><a href="#fn">2</a></sup>.</p>

    <p class="footy" id="otherid" lang="en"><sup id="fn"><a href="#fnrev">2</a></sup> Here are the details.</p>

Unlinked footref and footnote:
  notes: |
    Uses the '!' modifier on the footref to turn off linking to the footnote
    The textile tester removes the random ID from the text returned by textile in this test. This allows the rest of the output to be tested.
  input: |
    See[3!] for details.

    fn3. Here are the details.
  expect: |
    <p>See<sup class="footnote" id="fnrev">3</sup> for details.</p>

    <p class="footnote" id="fn"><sup>3</sup> Here are the details.</p>

Backlinked footref to footnote:
  notes: |
    Uses the '!' modifier on the footref to turn off linking to the footnote
    Uses the '^' modifier on the footnote to turn on reverse linking to the *first* use of the corresponding reference
    The textile tester removes the random ID from the text returned by textile in this test. This allows the rest of the output to be tested.
  input: |
    See[4!] for details.

    fn4^. Here are the details.
  expect: |
    <p>See<sup class="footnote" id="fnrev">4</sup> for details.</p>

    <p class="footnote" id="fn"><sup><a href="#fnrev">4</a></sup> Here are the details.</p>

Simple Note Links:
  input: |
    Scientists say[#lavader] the moon is quite small. But I, for one, don't believe them. Others claim it to be made of cheese[#aardman]. If this proves true I suspect we are in for troubled times[#apollo13] as people argue over their "share" of the moon's cheese. In the end, its limited size[#lavader] may prove problematic.

    note#lavader(noteclass). "Proof of the small moon hypothesis":http://antwrp.gsfc.nasa.gov/apod/ap080801.html. Copyright(c) Laurent Laveder

    note#aardman(#noteid). "Proof of a cheese moon":http://www.imdb.com/title/tt0104361

    note#apollo13. After all, things do go "wrong":http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident.

    notelist{padding:1em;margin:1em;border-bottom:1px solid gray}.

    notelist{padding:1em;margin:1em;border-bottom:1px solid gray}:§^.

    notelist{padding:1em;margin:1em;border-bottom:1px solid gray}:‡.

    notelist!.

  expect: |
    <p>Scientists say<sup><a href="#note"><span id="noteref">1</span></a></sup> the moon is quite small. But I, for one, don&#8217;t believe them. Others claim it to be made of cheese<sup><a href="#note"><span id="noteref">2</span></a></sup>. If this proves true I suspect we are in for troubled times<sup><a href="#note"><span id="noteref">3</span></a></sup> as people argue over their &#8220;share&#8221; of the moon&#8217;s cheese. In the end, its limited size<sup><a href="#note"><span id="noteref">1</span></a></sup> may prove problematic.</p>

    <ol style="border-bottom:1px solid gray;margin:1em;padding:1em;">
    	<li class="noteclass"><sup><a href="#noteref">a</a></sup> <sup><a href="#noteref">b</a></sup><span id="note"> </span><a href="http://antwrp.gsfc.nasa.gov/apod/ap080801.html">Proof of the small moon hypothesis</a>. Copyright&#169; Laurent Laveder</li>
    	<li id="noteid"><sup><a href="#noteref">a</a></sup><span id="note"> </span><a href="http://www.imdb.com/title/tt0104361">Proof of a cheese moon</a></li>
    	<li><sup><a href="#noteref">a</a></sup><span id="note"> </span>After all, things do go <a href="http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident">wrong</a>.</li>
    </ol>

    <ol style="border-bottom:1px solid gray;margin:1em;padding:1em;">
    	<li class="noteclass"><sup><a href="#noteref">§</a></sup><span id="note"> </span><a href="http://antwrp.gsfc.nasa.gov/apod/ap080801.html">Proof of the small moon hypothesis</a>. Copyright&#169; Laurent Laveder</li>
    	<li id="noteid"><sup><a href="#noteref">§</a></sup><span id="note"> </span><a href="http://www.imdb.com/title/tt0104361">Proof of a cheese moon</a></li>
    	<li><sup><a href="#noteref">§</a></sup><span id="note"> </span>After all, things do go <a href="http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident">wrong</a>.</li>
    </ol>

    <ol style="border-bottom:1px solid gray;margin:1em;padding:1em;">
    	<li class="noteclass"><sup><a href="#noteref">‡</a></sup> <sup><a href="#noteref">‡</a></sup><span id="note"> </span><a href="http://antwrp.gsfc.nasa.gov/apod/ap080801.html">Proof of the small moon hypothesis</a>. Copyright&#169; Laurent Laveder</li>
    	<li id="noteid"><sup><a href="#noteref">‡</a></sup><span id="note"> </span><a href="http://www.imdb.com/title/tt0104361">Proof of a cheese moon</a></li>
    	<li><sup><a href="#noteref">‡</a></sup><span id="note"> </span>After all, things do go <a href="http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident">wrong</a>.</li>
    </ol>

    <ol>
    	<li class="noteclass"><span> </span><a href="http://antwrp.gsfc.nasa.gov/apod/ap080801.html">Proof of the small moon hypothesis</a>. Copyright&#169; Laurent Laveder</li>
    	<li><span> </span><a href="http://www.imdb.com/title/tt0104361">Proof of a cheese moon</a></li>
    	<li><span> </span>After all, things do go <a href="http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident">wrong</a>.</li>
    </ol>

Links from already encoded URL:
  input:  |
    French "Cheeses":https://en.wikipedia.org/wiki/Appellation_d%27Origine_Contr%C3%B4l%C3%A9e
  expect: |
    <p>French <a href="https://en.wikipedia.org/wiki/Appellation_d%27Origine_Contr%C3%B4l%C3%A9e">Cheeses</a></p>

Note Links.:
  input: |
    Scientists say[#lavader] the moon is quite small. But I, for one, don't believe them. Others claim it to be made of cheese[#aardman]. If this proves true I suspect we are in for troubled times[#apollo13] as people argue over their "share" of the moon's cheese. In the end, its limited size[#lavader] may prove problematic.

    note#lavader. "Proof of the small moon hypothesis":http://antwrp.gsfc.nasa.gov/apod/ap080801.html. Copyright(c) Laurent Laveder

    note#aardman. "Proof of a cheese moon":http://www.imdb.com/title/tt0104361

    note#apollo13. After all, things do go "wrong":http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident.

    h2. Here are my references.

    notelist{padding:1em;margin:1em;border-bottom:1px solid gray}.
  expect: |
    <p>Scientists say<sup><a href="#note"><span id="noteref">1</span></a></sup> the moon is quite small. But I, for one, don&#8217;t believe them. Others claim it to be made of cheese<sup><a href="#note"><span id="noteref">2</span></a></sup>. If this proves true I suspect we are in for troubled times<sup><a href="#note"><span id="noteref">3</span></a></sup> as people argue over their &#8220;share&#8221; of the moon&#8217;s cheese. In the end, its limited size<sup><a href="#note"><span id="noteref">1</span></a></sup> may prove problematic.</p>

    <h2>Here are my references.</h2>

    <ol style="border-bottom:1px solid gray;margin:1em;padding:1em;">
    	<li><sup><a href="#noteref">a</a></sup> <sup><a href="#noteref">b</a></sup><span id="note"> </span><a href="http://antwrp.gsfc.nasa.gov/apod/ap080801.html">Proof of the small moon hypothesis</a>. Copyright&#169; Laurent Laveder</li>
    	<li><sup><a href="#noteref">a</a></sup><span id="note"> </span><a href="http://www.imdb.com/title/tt0104361">Proof of a cheese moon</a></li>
    	<li><sup><a href="#noteref">a</a></sup><span id="note"> </span>After all, things do go <a href="http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident">wrong</a>.</li>
    </ol>

Unlinked Note References with backlinked and unreferenced definitions:
  input: |
    Scientists say[#lavader!] the moon is quite small. But I, for one, don't believe them. Others claim it to be made of cheese[#aardman!]. If this proves true I suspect we are in for troubled times[#apollo13!] as people argue over their "share" of the moon's cheese. In the end, its limited size[#lavader!] may prove problematic.

    note#unused. An unreferenced note.

    note#lavader^. "Proof of the small moon hypothesis":http://antwrp.gsfc.nasa.gov/apod/ap080801.html. Copyright(c) Laurent Laveder

    note#aardman^. "Proof of a cheese moon":http://www.imdb.com/title/tt0104361

    note#apollo13^. After all, things do go "wrong":http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident.

    notelist{padding:1em;margin:1em;border-bottom:1px solid gray}:α!+.
  expect: |
    <p>Scientists say<sup><span id="noteref">1</span></sup> the moon is quite small. But I, for one, don&#8217;t believe them. Others claim it to be made of cheese<sup><span id="noteref">2</span></sup>. If this proves true I suspect we are in for troubled times<sup><span id="noteref">3</span></sup> as people argue over their &#8220;share&#8221; of the moon&#8217;s cheese. In the end, its limited size<sup><span id="noteref">1</span></sup> may prove problematic.</p>

    <ol style="border-bottom:1px solid gray;margin:1em;padding:1em;">
    	<li><sup><a href="#noteref">α</a></sup><span id="note"> </span><a href="http://antwrp.gsfc.nasa.gov/apod/ap080801.html">Proof of the small moon hypothesis</a>. Copyright&#169; Laurent Laveder</li>
    	<li><sup><a href="#noteref">α</a></sup><span id="note"> </span><a href="http://www.imdb.com/title/tt0104361">Proof of a cheese moon</a></li>
    	<li><sup><a href="#noteref">α</a></sup><span id="note"> </span>After all, things do go <a href="http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident">wrong</a>.</li>
    	<li>An unreferenced note.</li>
    </ol>

Malformed notelist:
  input:  |
    Scientists say[#lavader] the moon is quite small. But I, for one, don't believe them. Others claim it to be made of cheese[#aardman]. If this proves true I suspect we are in for troubled times[#apollo13!] as people argue over their "share" of the moon's cheese. In the end, its limited size[#lavader] may prove problematic.

    note#unused An unreferenced note.

    note#lavader^ "Proof of the small moon hypothesis":http://antwrp.gsfc.nasa.gov/apod/ap080801.html. Copyright(c) Laurent Laveder

    note#aardman^ "Proof of a cheese moon":http://www.imdb.com/title/tt0104361

    note#apollo13^ After all, things do go "wrong":http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident.

    notelist{padding:1em;margin:1em;border-bottom:1px solid gray}:α!+
  expect: |
    <p>Scientists say<sup><a href="#note"><span id="noteref">1</span></a></sup> the moon is quite small. But I, for one, don&#8217;t believe them. Others claim it to be made of cheese<sup><a href="#note"><span id="noteref">2</span></a></sup>. If this proves true I suspect we are in for troubled times<sup><span id="noteref">3</span></sup> as people argue over their &#8220;share&#8221; of the moon&#8217;s cheese. In the end, its limited size<sup><a href="#note"><span id="noteref">1</span></a></sup> may prove problematic.</p>

    <ol style="border-bottom:1px solid gray;margin:1em;padding:1em;">
    	<li><sup><a href="#noteref">α</a></sup><span id="note"> </span><a href="http://antwrp.gsfc.nasa.gov/apod/ap080801.html">Proof of the small moon hypothesis</a>. Copyright&#169; Laurent Laveder</li>
    	<li><sup><a href="#noteref">α</a></sup><span id="note"> </span><a href="http://www.imdb.com/title/tt0104361">Proof of a cheese moon</a></li>
    	<li><sup><a href="#noteref">α</a></sup><span id="note"> </span>After all, things do go <a href="http://en.wikipedia.org/wiki/Apollo_13#The_oxygen_tank_incident">wrong</a>.</li>
    	<li>An unreferenced note.</li>
    </ol>

Empty notelist:
  input: |
    There should be nothing below.

    notelist.
  expect: |
    <p>There should be nothing below.</p>

Undefined note:
  input: |
    Paragraph with a note[#note] and more, but no definition.

    notelist.
  expect: |
    <p>Paragraph with a note<sup><a><span>1</span></a></sup> and more, but no definition.</p>

    <ol>
    	<li><sup><a>a</a></sup> Undefined Note [#1].</li>
    </ol>

Issue 72 - spans around foreign chars:
  input  : |
    *W skład zestawu wchodzą*:

    *W skład zestawu wchodzą*:\x20
  expect : |
    <p><strong>W skład zestawu wchodzą</strong>:</p>

    <p><strong>W skład zestawu wchodzą</strong>: </p>

Textile comments:
  input: |
    ###. Here's a comment.

    h3. Hello

    ###. And
    another
    one.

    Goodbye.
  expect : |
    <h3>Hello</h3>

    <p>Goodbye.</p>

Smileys still smileys:
  notes: Make sure smileys don't get recognised as a definition list.
  input: |
    :(

    :)

    :(\x20
    :(\x20
    :(\x20
    :)\x20

    Pinocchio!
    :^)

    Baboon!
    :=)

    Wink!
    ;)

    :[\x20
    :]

    ;(
    something
    dark side
    :)\x20

    ;(c)[de] Item

  expect: |
    <p>:(</p>

    <p>:)</p>

    <p>:( <br />
    :( <br />
    :( <br />
    :) </p>

    <p>Pinocchio!<br />
    :^)</p>

    <p>Baboon!<br />
    :=)</p>

    <p>Wink!<br />
    ;)</p>

    <p>:[ <br />
    :]</p>

    <p>;(<br />
    something<br />
    dark side<br />
    :) </p>

    <dl class="c" lang="de">
    	<dt>Item</dt>
    </dl>

Styles on phrase modifiers:
  input: |
    ~{text-align:right;}My text~

    %{text-align:right;}My text%

    ^{text-align:right;}My text^

    ??{text-align:right;}My text??

    *{text-align:right;}My text*

    **{text-align:right;}My text**

    -{text-align:right;}My text-

    +{text-align:right;}My text+

    _{text-align:right;}My text_

    __{text-align:right;}My text__

    @{text-align:right;}My text@

    _{content:大阪府;}Unicode style_
  expect: |
    <p><sub style="text-align:right;">My text</sub></p>

    <p><span style="text-align:right;">My text</span></p>

    <p><sup style="text-align:right;">My text</sup></p>

    <p><cite style="text-align:right;">My text</cite></p>

    <p><strong style="text-align:right;">My text</strong></p>

    <p><b style="text-align:right;">My text</b></p>

    <p><del style="text-align:right;">My text</del></p>

    <p><ins style="text-align:right;">My text</ins></p>

    <p><em style="text-align:right;">My text</em></p>

    <p><i style="text-align:right;">My text</i></p>

    <p><code>{text-align:right;}My text</code></p>

    <p><em style="content:大阪府;">Unicode style</em></p>

Classes/ids/langs on phrase modifiers:
  input: |
    ~(c#id)[en]My text~

    %(c#id)[En]My text%

    ^(c#id)[EN]My text^

    ??(c#id)[en-gb]My text??

    *(c#id)[en-GB]My text*

    **(c#id)[en-Gb]My text**

    -(c#id)[ENG]My text-

    +(c#id)[eng]My text+

    _(c#id)[kjwwef89]My text_

    __(c#id)[12]My text__

    @(c#id)[Whatever]My text@
  expect: |
    <p><sub class="c" id="id" lang="en">My text</sub></p>

    <p><span class="c" id="id" lang="En">My text</span></p>

    <p><sup class="c" id="id" lang="EN">My text</sup></p>

    <p><cite class="c" id="id" lang="en-gb">My text</cite></p>

    <p><strong class="c" id="id" lang="en-GB">My text</strong></p>

    <p><b class="c" id="id" lang="en-Gb">My text</b></p>

    <p><del class="c" id="id">My text</del></p>

    <p><ins class="c" id="id">My text</ins></p>

    <p><em class="c" id="id">My text</em></p>

    <p><i class="c" id="id">My text</i></p>

    <p><code>(c#id)[Whatever]My text</code></p>

Classes/ids/langs on phrase modifiers (restricted):
  setup:
    - setRestricted: true
    - setLite: true
    - setImages: false
    - setLinkRelationShip: nofollow
    - setDocumentType: html5
  input:  |
    ~(c#id)[en]My text~

    %(c#id)[En]My text%

    ^(c#id)[EN]My text^

    ??(c#id)[en-gb]My text??

    *(c#id)[en-GB]My text*

    **(c#id)[en-Gb]My text**

    -(c#id)[ENG]My text-

    +(c#id)[eng]My text+

    _(c#id)[kjwwef89]My text_

    __(c#id)[12]My text__

    @(c#id)[Whatever]My text@
  expect: |
    <p><sub lang="en">My text</sub></p>

    <p><span lang="En">My text</span></p>

    <p><sup lang="EN">My text</sup></p>

    <p><cite lang="en-gb">My text</cite></p>

    <p><strong lang="en-GB">My text</strong></p>

    <p><b lang="en-Gb">My text</b></p>

    <p><del>My text</del></p>

    <p><ins>My text</ins></p>

    <p><em>My text</em></p>

    <p><i>My text</i></p>

    <p>@(c#id)[Whatever]My text@</p>

Github Issue 50 (en-dash and strike):
  input: |
    fjfhfjhf
    fhfhfh
    xyz

    - fjfhfjhf
    - fhfhfh
    - xyz

    a -b-
    a -b-\x20
    a - b
    a -b
    a- b
    a-b
    -b
    a-
    b
    a -
    b
    a -\x20
    b
  expect: |
    <p>fjfhfjhf<br />
    fhfhfh<br />
    xyz</p>

    <p>- fjfhfjhf<br />
    - fhfhfh<br />
    - xyz</p>

    <p>a <del>b</del><br />
    a <del>b</del> <br />
    a &#8211; b<br />
    a -b<br />
    a- b<br />
    a-b<br />
    -b<br />
    a-<br />
    b<br />
    a -<br />
    b<br />
    a &#8211; <br />
    b</p>

Empty things:
  input: |
    ''

    ""

    %%

    ^^

    &&

    **

    __

    --

    ++

    ~~

    {}

    []

    ()

    <>

    \\

    //

    ??

    ==

    @@

    ##

    $$

    !!

    ::

    ;;

    ..

    ,,

    ||

    ` `

    ' '

    " "

    % %

    ^ ^

    & &

    * *

    _ _

    - -

    + +

    ~ ~

    { }

    [ ]

    ( )

    < >

    \ \

    / /

    ? ?

    = =

    @ @

    # #

    $ $

    ! !

    : :

    ; ;

    . .

    , ,

  expect: |
    <p>&#8216;&#8217;</p>

    <p>&#8220;&#8221;</p>

    <p>%%</p>

    <p>^^</p>

    <p>&amp;&amp;</p>

    <p>**</p>

    <p>__</p>

    <p>&#8212;</p>

    <p>++</p>

    <p>~~</p>

    <p>{}</p>

    <p>[]</p>

    <p>()</p>

    <p>&lt;&gt;</p>

    <p>\\</p>

    <p>//</p>

    <p>??</p>

    <p>==</p>

    <p><code></code></p>

    <p>##</p>

    <p>$$</p>

    <p>!!</p>

    <p>::</p>

    <p>;;</p>

    <p>..</p>

    <p>,,</p>

    <table>
    		<tr>
    			<td></td>
    		</tr>
    </table>

    <p>` `</p>

    <p>&#8216; &#8216;</p>

    <p>&#8220; &#8220;</p>

    <p>% %</p>

    <p>^ ^</p>

    <p>&amp; &amp;</p>

    <ul>
    	<li>*</li>
    </ul>

    <p>_ _</p>

    <p>- -</p>

    <p>+ +</p>

    <p>~ ~</p>

    <p>{ }</p>

    <p>[ ]</p>

    <p>( )</p>

    <p>&lt; &gt;</p>

    <p>\ \</p>

    <p>/ /</p>

    <p>? ?</p>

    <p>= =</p>

    <p><code> </code></p>

    <ol>
    	<li>#</li>
    </ol>

    <p>$ $</p>

    <p>! !</p>

    <dl>
    	<dd>:</dd>
    </dl>

    <dl>
    	<dt>;</dt>
    </dl>

    <p>. .</p>

    <p>, ,</p>

Restricted mode security filtering mode with default options:
  setup:
    - setRestricted: true
    - setLite: true
    - setImages: false
    - setLinkRelationShip: nofollow
  input: |
    !10x10.gif!

    "bad protocol":file://local/file

    "javascript link":javacript:window.alert()

    "nofollow":http://example.com

    notextile. <iframe src="xss/attempt"></iframe><&#123><script>window.alert('success')</script>

    !http://example.com/<script>window.alert("Hello World!");</script>.png!

    "test":link1
    [link1]http://example.com/<script>window.alert("HelloWorld!");</script>

    <!-- <a href="#">HTTML comment</a> -->
  expect: |
    <p>!10&#215;10.gif!</p>

    <p>&#8220;bad protocol&#8221;:file://local/file</p>

    <p>&#8220;javascript link&#8221;:javacript:window.alert()</p>

    <p><a href="http://example.com" rel="nofollow">nofollow</a></p>

    <p>notextile. &lt;iframe src=&#8220;xss/attempt&#8221;&gt;&lt;/iframe&gt;&lt;&amp;#123&gt;&lt;script&gt;window.alert(&#8216;success&#8217;)&lt;/script&gt;</p>

    <p>!http://example.com/&lt;script&gt;window.alert(&#8220;Hello World!&#8221;);&lt;/script&gt;.png!</p>

    <p><a href="http://example.com/%26lt%3Bscript%26gt%3Bwindow.alert%28%22HelloWorld%21%22%29%3B%26lt%3B/script%26gt%3B" rel="nofollow">test</a></p>

    <p>&lt;!&#8212; &lt;a href=&#8221;#&#8221;&gt;<span class="caps">HTTML</span> comment&lt;/a&gt; &#8212;&gt;</p>

Token references:
  input: |
    Hello textileopentag0000000001z World!

    Try looking up textileRef:0000:84712874324.
  expect: |
    <p>Hello textileopentag0000000001z World!</p>

    <p>Try looking up textileRef:0000:84712874324.</p>

Link and image encoding:
  input: |
    !http://example.com/?size=60&file=image.png!

    !http://example.com/needs<&"encoding.png!

    "Requires encoding":http://example.com/?foo&bar

    "Entity is merely part of text":http://example.com/?foo&amp;bar

    "In path component":http://example.com/&.html
  expect: |
    <p><img alt="" src="http://example.com/?size=60&amp;file=image.png" /></p>

    <p><img alt="" src="http://example.com/needs&lt;&amp;&quot;encoding.png" /></p>

    <p><a href="http://example.com/?foo&amp;bar">Requires encoding</a></p>

    <p><a href="http://example.com/?foo&amp;amp;bar">Entity is merely part of text</a></p>

    <p><a href="http://example.com/%26.html">In path component</a></p>
